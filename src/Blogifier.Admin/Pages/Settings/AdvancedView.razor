@layout SettingsLayout
@page "/admin/settings/advanced/"
@inject IStringLocalizer<Resource> _localizer
@inject HttpClient _http

<PageTitle Title="@_localizer["Advanced Settings"]" />

<h1 class="section-title">@_localizer["Advanced settings"]</h1>

<div class="section-content">
    @if (Configuration != null)
    {
    <EditForm Model="@Configuration" OnValidSubmit="Save">
        <div class="form-item">
            <div class="form-check form-switch">
                <input class="form-check-input" @bind="Configuration.Active" type="checkbox" id="UnderDevelopSwitch">
                <label class="form-check-label" for="UnderDevelopSwitch">Page under development</label>
            </div>
        </div>
        <div class="form-item">
            <button type="submit" class="btn btn-blogifier px-5">@_localizer["save"]</button>
        </div>
    </EditForm>
    }
</div>
<ToasterComponent @ref="Toaster" />

@code {
    private Configuration Configuration{ get; set; }
    protected ToasterComponent Toaster;

    protected override async Task OnInitializedAsync()
    {
        Configuration = await _http.GetFromJsonAsync<Configuration>("api/config/UnderDevelopment");
    }

    protected async Task Save()
    {
        Toaster.Toast(await _http.PutAsJsonAsync<Configuration>("api/config/"+Configuration.Name, Configuration));
    }
}

